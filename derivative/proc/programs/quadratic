PUSH 0
IN
POP rax #rax = a
PUSH rax
JE :linear #if a == 0 solve linear


IN
IN
POP rcx #rcx = c
POP rbx #rbx = b

PUSH rbx
PUSH rbx
MUL #b^2
PUSH 4
PUSH rax
PUSH rcx
MUL #ac
MUL #4ac
SUB #b^2 - 4ac =: D
POP rdx

PUSH 0
PUSH rdx
JA :zero # if D < 0 0 roots

PUSH rax 
PUSH 2
MUL
POP rax # rax = 2a

PUSH rdx
PUSH 0
JE :one # D == 0 one root

PUSH 2
OUT

PUSH rdx
SQRT # sqrt(D)

PUSH rbx
SUB # sqrt(D) - b

PUSH rax
DIV # (sqrt(D) - b) / 2a
POP rdx # rdx = x_1

PUSH rdx
PUSH rdx
OUT

PUSH -1

MUL # -x_1
PUSH rbx
PUSH rax
DIV
PUSH 2
MUL # b / a
SUB # -x_1 - b / a == (b - sqrt(D)) / 2a - b / a = (-b - sqrt(D)) / 2a =: x_2
OUT
END

:zero
PUSH 0
OUT
END

:one
PUSH 1
OUT
PUSH rbx
PUSH rax
DIV
PUSH -1
MUL # -b / 2a
OUT
END

:linear
PUSH 0
IN
POP rbx
PUSH rbx
JE :c # b == 0 answer depends on c
IN
PUSH -1
MUL
PUSH 1
OUT
POP rcx
PUSH rcx
PUSH rbx
DIV # -c / b
OUT
END

:c
PUSH 0
IN
JNE :zero # c != 0 no roots
PUSH inf # c == 0 inf roots
OUT
END
